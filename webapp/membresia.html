<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Membresía - TuCitaSegura</title>
    <link rel="stylesheet" href="./css/output.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body class="text-white bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <div class="text-center mb-8">
            <h1 class="text-4xl font-bold mb-4 bg-gradient-to-r from-purple-400 to-pink-400 bg-clip-text text-transparent">
                Membresía Premium
            </h1>
            <p class="text-xl text-slate-300">Desbloquea todas las funciones de TuCitaSegura</p>
        </div>

        <!-- Single Membership Plan -->
        <div class="max-w-md mx-auto">
            <div class="bg-white/10 backdrop-blur-lg rounded-2xl p-8 border-2 border-purple-500 relative">
                <div class="absolute -top-3 left-1/2 transform -translate-x-1/2">
                    <span class="bg-purple-500 text-white px-4 py-1 rounded-full text-sm font-bold">
                        MEMBRESÍA ÚNICA
                    </span>
                </div>
                
                <div class="text-center mb-8">
                    <div class="w-20 h-20 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full flex items-center justify-center mx-auto mb-6">
                        <i class="fas fa-crown text-3xl text-white"></i>
                    </div>
                    <h3 class="text-2xl font-bold mb-4">Membresía Premium</h3>
                    <div class="text-4xl font-bold mb-2">€30.00</div>
                    <div class="text-lg text-slate-300 mb-2">+ IVA por mes</div>
                    <div class="text-sm text-purple-300">Acceso completo a todas las funciones</div>
                </div>
                
                <ul class="space-y-4 mb-8">
                    <li class="flex items-center gap-3">
                        <i class="fas fa-check text-green-400"></i>
                        <span>Mensajes ilimitados</span>
                    </li>
                    <li class="flex items-center gap-3">
                        <i class="fas fa-check text-green-400"></i>
                        <span>Ver perfiles completos</span>
                    </li>
                    <li class="flex items-center gap-3">
                        <i class="fas fa-check text-green-400"></i>
                        <span>Citas ilimitadas</span>
                    </li>
                    <li class="flex items-center gap-3">
                        <i class="fas fa-check text-green-400"></i>
                        <span>Video llamadas ilimitadas</span>
                    </li>
                    <li class="flex items-center gap-3">
                        <i class="fas fa-check text-green-400"></i>
                        <span>Eventos VIP premium</span>
                    </li>
                    <li class="flex items-center gap-3">
                        <i class="fas fa-check text-green-400"></i>
                        <span>Perfil destacado</span>
                    </li>
                    <li class="flex items-center gap-3">
                        <i class="fas fa-check text-green-400"></i>
                        <span>Matchmaking personalizado</span>
                    </li>
                    <li class="flex items-center gap-3">
                        <i class="fas fa-check text-green-400"></i>
                        <span>Soporte prioritario</span>
                    </li>
                </ul>
                
                <button onclick="subscribe('premium')" class="w-full bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 py-4 rounded-xl font-bold text-lg transition transform hover:scale-105">
                    Suscribirse Ahora
                </button>
            </div>
        </div>

        <!-- FAQ Section -->
        <div class="max-w-4xl mx-auto mt-12">
            <h2 class="text-2xl font-bold text-center mb-8">Preguntas Frecuentes</h2>
            
            <div class="space-y-4">
                <div class="bg-white/10 backdrop-blur-lg rounded-xl p-4 border border-white/20">
                    <h4 class="font-semibold mb-2">¿Puedo cancelar mi suscripción?</h4>
                    <p class="text-slate-300 text-sm">Sí, puedes cancelar en cualquier momento desde tu perfil.</p>
                </div>
                
                <div class="bg-white/10 backdrop-blur-lg rounded-xl p-4 border border-white/20">
                    <h4 class="font-semibold mb-2">¿Hay prueba gratuita?</h4>
                    <p class="text-slate-300 text-sm">Ofrecemos 7 días de prueba gratuita para el plan Premium.</p>
                </div>
                
                <div class="bg-white/10 backdrop-blur-lg rounded-xl p-4 border border-white/20">
                    <h4 class="font-semibold mb-2">¿Es seguro el pago?</h4>
                    <p class="text-slate-300 text-sm">Usamos Stripe y PayPal para procesar pagos de forma segura.</p>
                </div>
            </div>
        </div>
    </div>

    <script type="module">
        import { auth, db } from './js/firebase-config.js';
        import { onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
        import { doc, getDoc, setDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";
        
        let currentUser = null;
        
        onAuthStateChanged(auth, (user) => {
            if (user) {
                currentUser = user;
            } else {
                alert('Debes iniciar sesión para ver membresías');
                window.location.href = '/login.html';
            }
        });
        
        window.subscribe = async function(plan) {
            if (!currentUser) {
                alert('Debes iniciar sesión');
                return;
            }
            
            const planPrices = {
                premium: 3000  // €30.00 in cents
            };
            
            if (confirm(`¿Confirmar suscripción al plan ${plan.toUpperCase()} por €${(planPrices[plan]/100).toFixed(2)}?`)) {
                try {
                    // Create subscription using Firebase Cloud Function
                    const createSubscription = firebase.functions().httpsCallable('createStripeSubscription');
                    const result = await createSubscription({
                        plan: plan,
                        price: planPrices[plan]
                    });
                    
                    if (result.data.success) {
                        alert('¡Suscripción creada exitosamente!');
                        window.location.href = '/webapp/perfil.html';
                    } else {
                        throw new Error(result.data.error || 'Error al crear suscripción');
                    }
                } catch (error) {
                    console.error('Error:', error);
                    alert('Error al procesar suscripción: ' + error.message);
                }
            }
        };
    </script>
</body>
</html>